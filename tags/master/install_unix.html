<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>STXXL: Compiling and Installing STXXL on Linux/Unix Variants</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STXXL
   &#160;<span id="projectnumber">1.4-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('install_unix.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Compiling and Installing STXXL on Linux/Unix Variants </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Timo Bingmann (2013)</dd></dl>
<p>Precondition: Make sure GNU <code>make</code>, <code>CMake</code> &gt;= 2.6.4, <code>git</code> and a C++ compiler are installed. See <a class="el" href="faq.html#faq_compilers">Supported Compilers and Platforms</a> which systems and compilers are currently supported.</p>
<p>There are three methods to use STXXL:</p>
<ul>
<li>The first is recommended for small <b>prototype projects</b> consisting of only a few source files. It uses the <code>local/</code> directory within the STXXL directory tree.</li>
<li>For <b>larger development</b> projects, the STXXL library can be linked as a library inside a subdirectory.</li>
<li>For distributing <b>independent sources</b>, the STXXL library can be localed using CMake's <code>find_package()</code> mechanism.</li>
</ul>
<p>There are quite some <a class="el" href="install_build_options.html">Options for Build Configuration</a>, which you can use when building STXXL with CMake.</p>
<h1><a class="anchor" id="install_unix_local"></a>
First-Time Compile and Simple Projects in local/</h1>
<ol type="1">
<li>Clone the STXXL project repository as <code><b>my-project</code></b>. <pre class="fragment">$ git clone http://github.com/stxxl/stxxl.git my-project
</pre></li>
<li>Compile the STXXL library in a <code>build</code> subdirectory, including the example in <code>local/</code>. <pre class="fragment">$ mkdir my-project/build
$ cd my-project/build
$ cmake ..
&lt;lots of output by cmake&gt;
$ make
&lt;lots of compilation messages&gt;
</pre></li>
<li>Run the example program <code>test1</code> in <code>local/</code> <pre class="fragment">(inside my-project/build/)
$ cd local
$ ./test1
&lt;lots of output&gt;
</pre></li>
</ol>
<p>For your own prototype project you can immediately start modifying <code>test1.cpp</code> or create a new .cpp in <code>local/</code>. The CMake scripts will automatically compile and link all .cpp files in <code>local/</code> correctly with STXXL.</p>
<p>The CMake file has many build options (see <a class="el" href="install_build_options.html">Options for Build Configuration</a>). Maybe the most important are <code>BUILD_TESTS</code> and <code>BUILD_EXAMPLES</code>. By setting them with <code>"-DBUILD_EXAMPLES=ON -DBUILD_TESTS=ON"</code> on the CMake line, additional subprojects are added to the build.</p>
<p>By default, STXXL compiles in <code>Debug</code> mode and includes many assertions and run-time checks, which typically slow down performance dramatically. To use STXXL at <b>full speed</b>, please set the build type to <code>Release</code> by adding <code>-DCMAKE_BUILD_TYPE=Release</code> to the cmake line.</p>
<h1><a class="anchor" id="install_unix_subproject"></a>
Including STXXL as a CMake Subproject</h1>
<p>The second method is for including STXXL in a larger program as a subproject. This is particularly easy with CMake: one can just <code>add_directory(stxxl)</code> in a CMakeLists.txt. The following guide shows how to start a simple CMake project and use STXXL in a subdirectory.</p>
<p>The advantage of this method is that the STXXL is a subproject of your's. Thereby it will always be compiled with the <b>same set</b> of CFLAGS or CMAKE_BUILD_TYPE as your project. This is most convenient for developing projects, as the STXXL has a lot of debug code. When running experiments or going into production, the whole project must be built with <code>CMAKE_BUILD_TYPE=Release</code> or similar to remove the debug code.</p>
<ol type="1">
<li>Create an empty directory <code>"my-project"</code> and clone the STXXL inside it. <pre class="fragment">$ mkdir my-project
$ cd my-project
$ git clone http://github.com/stxxl/stxxl.git
</pre></li>
<li>Create a file named <code>CMakeLists.txt</code> inside your <code>my-project</code> folder with the following sample content: <pre class="fragment"># CMakeLists.txt example for STXXL

project(my-project)
cmake_minimum_required(VERSION 2.8)

# disallow in-source builds
if("${PROJECT_SOURCE_DIR}" STREQUAL "${PROJECT_BINARY_DIR}")
  message(SEND_ERROR "In-source builds are not allowed.")
endif("${PROJECT_SOURCE_DIR}" STREQUAL "${PROJECT_BINARY_DIR}")

# enable warnings (always good)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -W -Wall")

# include the STXXL library in my-project
add_subdirectory(stxxl)

# apply STXXL CXXFLAGS to our configuration
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${STXXL_CXX_FLAGS}")

# add STXXL includes path
include_directories(${STXXL_INCLUDE_DIRS})

# build a program and link it with STXXL.
add_executable(project main.cpp)
target_link_libraries(project ${STXXL_LIBRARIES})
</pre></li>
<li>To show how that this build system works, we now copy the <code>test1.cpp</code> from STXXL to the new project as <code>main.cpp</code> and build it. <pre class="fragment">$ cp stxxl/local/test1.cpp main.cpp
$ mkdir build
$ cd build
$ cmake ..
&lt;lots of output by cmake&gt;
$ make
&lt;lots of compilation messages&gt;
</pre></li>
<li>Test the compilation by running <code>project</code> <pre class="fragment">$ ./project
</pre></li>
</ol>
<h1><a class="anchor" id="install_unix_library"></a>
Including STXXL as a Library</h1>
<p>STXXL compiles into a static (and optionally shared) library plus template include files, which may be included in binary distributions.</p>
<p>If a binary STXXL package is installed, the following few CMake lines will automatically detect it and configure a program to build with the appropriate CXXFLAGS, include directories and libraries: </p>
<pre class="fragment"># search for stxxl-config.cmake which contains the library's configuration
find_package(STXXL REQUIRED)

# print some info (this can be removed)
message(STATUS "STXXL_CXX_FLAGS: ${STXXL_CXX_FLAGS}")
message(STATUS "STXXL_INCLUDE_DIRS: ${STXXL_INCLUDE_DIRS}")
message(STATUS "STXXL_LIBRARIES: ${STXXL_LIBRARIES}")

# apply CXXFLAGS to our configuration
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${STXXL_CXX_FLAGS}")

# add STXXL include directory
include_directories(${STXXL_INCLUDE_DIRS})

# create and executable and linke with STXXL
add_executable(your_program main.cpp)
target_link_libraries(your_program ${STXXL_LIBRARIES})
</pre><p>We have create a simple example project, which contains the lines above and an example program. The source is available via github: </p>
<pre class="fragment">git clone http://github.com/stxxl/myproject.git
</pre><p> See the README at <a href="http://github.com/stxxl/myproject">http://github.com/stxxl/myproject</a></p>
<h1>Create a Disk Configuration File</h1>
<p>For STXXL to function beyond very simple examples, you must define the <a class="el" href="install_config.html">disk configuration file </a>. The simplest method is to create a file named <b><code>'.stxxl'</code></b> the same directory as you execute the program. A basic configuration might be: </p>
<pre class="fragment"># file path,maximum capacity of the disk,access method
disk=/tmp/stxxl,1G,syscall unlink
</pre><p> Please see <a class="el" href="install_config.html">Disk Configuration Files</a> for further available options.</p>
<h1>Notes for Linux Distribution Package Maintainers</h1>
<p>Package maintainers should make sure that <b>both</b> Debug and Release static libraries are available via the distribution package system. We currently cannot keep a stable binary interface for the library, thus providing versioned shared libraries is not a good idea.</p>
<ul>
<li>The CMake build scripts will generate static and exclude shared libraries when run with <code>"-DBUILD_STATIC_LIBS=ON -DBUILD_SHARED_LIBS=OFF"</code>.</li>
<li>Debug libraries are suffixed with "_debug". Due to CMake's system, the library must be compiled once in Debug mode and once in Release mode! (see below)</li>
<li>Running "make install" will correctly install the tree into <code>CMAKE_INSTALL_PREFIX</code>.</li>
<li>The binary package should only contain the <code>stxxl_tool</code> (since we do not provide shared libraries). Alternatively, the tool can packaged in an additional <code>tools</code> package, thus leaving the binary package empty. The <code>test1</code> binary must not be included.</li>
<li>The development package must contain all installed headers, and both "libstxxl.a" and "libstxxl_debug.a". <br/>
 The CMake script will also install CMake project files in <code>lib/cmake/stxxl</code> , which must be included in the development package. <br/>
 We also provide a <code>pkg-config</code> file, which installs by default into <code>lib/pkgconfig/</code> as <code>stxxl.pc</code> and <code>stxxl_debug.pc</code> </li>
<li>Binary Unix packages should not use Boost.</li>
</ul>
<p>A typical build sequence would be </p>
<pre class="fragment">mkdir debug; cd debug
cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_STATIC_LIBS=ON $SRCDIR
make -j4 &amp;&amp; make install
cd ..
mkdir release; cd release
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_STATIC_LIBS=ON $SRCDIR
make -j4 &amp;&amp; make install
</pre><p> When building in this order the <b>stxxl_tool</b> will be built twice, and the Debug binary will be overwritten with the Release binary. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Welcome to STXXL</a></li><li class="navelem"><a class="el" href="install.html">Compilation and Configuration</a></li>
    <li class="footer"><a href="http://github.com/stxxl/stxxl/commit/0a80a8c55993948f7f2f6c2c5a51ff45b403045b">STXXL 1.4.1-380-g0a80a8c</a><script type="text/javascript">
var _paq = _paq || [];  _paq.push(['trackPageView']);  _paq.push(['enableLinkTracking']);  (function() {    var u='http://panthema.net/wik-331/';    _paq.push(['setTrackerUrl', u+'js/']);    _paq.push(['setSiteId', '1']);    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';    g.defer=true; g.async=true; g.src=u+'js/'; s.parentNode.insertBefore(g,s);  })();
</script>
<noscript><img src="http://panthema.net/wik-331/js/?idsite=1&amp;rec=1" style="border:0" alt="" /></noscript> - Generated on Sat Feb 11 2017 06:26:30 for STXXL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
