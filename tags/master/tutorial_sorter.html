<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>STXXL: STXXL Sorter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STXXL
   &#160;<span id="projectnumber">1.4-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tutorial_sorter.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">STXXL Sorter </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section introduces into the STXXL sorter container (to learn more about the structure of <a class="el" href="classstxxl_1_1sorter.html" title="External sorter container.   Introduction  to sorter container: see STXXL Sorter tutorial.   Design and Internals  of sorter container: see Sorter. ">stxxl::sorter</a>, see section <a class="el" href="classstxxl_1_1sorter.html">stxxl::sorter</a>).</p>
<p>The STXXL sorter container combines the two functions of runs_creator and runs_merger from the stream packages into a two-phase container. As a result, the STXXL sorter implements a external memory k-way merge sort to sort large amounts of data.</p>
<h3>Create a STXXL sorter</h3>
<p>Before using a STXXL sorter, we initially have to define and then to instantiate a sorter object. Two template parameters are required to define a <a class="el" href="classstxxl_1_1sorter.html" title="External sorter container.   Introduction  to sorter container: see STXXL Sorter tutorial.   Design and Internals  of sorter container: see Sorter. ">stxxl::sorter</a>. ValueType defines the type of the contained objects (must be a POD with no references to internal memory) and CompareType is the type of comparison object used for sorting the runs (see example below). BlockSize and AllocStr are optional (see <a class="el" href="classstxxl_1_1sorter.html">stxxl::sorter</a> for additional information). The more straightforward of the two sorter constructors expects the comparator object and memory_to_use (bytes) in ram for sorted runs as parameters.</p>
<div class="fragment"><div class="line"><span class="comment">// template parameter &lt;ValueType, CompareType, BlockSize(optional), AllocStr(optional)&gt;</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="classstxxl_1_1sorter.html">stxxl::sorter&lt;int, my_comparator, 1*1024*1024&gt;</a> sorter_type;</div>
<div class="line"></div>
<div class="line"><span class="comment">// create sorter object (CompareType(), MemoryToUse)</span></div>
<div class="line">sorter_type int_sorter(my_comparator(), 64*1024*1024);</div>
</div><!-- fragment --><p>The comparator class may look as follows. The operator() is needed to compare two given elements a and b. CompareType must also provide a min_value() method, that returns the value of type ValueType that is smaller than any element of the queue x, i.e. CompareType(CompareType.min_value(),x) is always true as well as a max_value() method that works equivalent: </p>
<div class="fragment"><div class="line"><span class="comment">// achieve an ascending order of sorting</span></div>
<div class="line"><span class="keyword">struct </span>my_comparator</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;a, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;b)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">return</span> a &lt; b;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> min_value()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="uint__types_8h.html#a969c1286bbe8eeb8811dac7a462d4a78">std::numeric_limits&lt;int&gt;::min</a>();</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> max_value()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="uint__types_8h.html#a0cfacbbf6e846521326f5de5ba3ecd05">std::numeric_limits&lt;int&gt;::max</a>();</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p>Note that CompareType must define strict weak ordering. <br/>
<br/>
The sorter container know two different kind of states - the input state and a output state. Insertion of elements are only allowed when the sorter is in the input state. After sorting is called, the container enters the output state and inserting elements is disallowed.</p>
<h3>Insert elements</h3>
<p>Inserting elements is possible into the sorter container by calling the push() function: </p>
<div class="fragment"><div class="line">int_sorter.push(5);</div>
<div class="line">int_sorter.push(10);</div>
<div class="line">int_sorter.push(3);</div>
</div><!-- fragment --><h3>Sorting all elements</h3>
<p>Sorting all elements a sorter container is holding, call <a class="el" href="group__stlalgo.html#ga5fcb89548cf48f273e140e973af6df33" title="Sort records comparison-based, see stxxl::sort -- Sorting Comparison-Based. ">sort()</a>: </p>
<div class="fragment"><div class="line">int_sorter.sort();</div>
</div><!-- fragment --><h3>Access sorted elements</h3>
<p>After calling sort, the items ca be read in sorted order using the operator*(), using <a class="el" href="uint__types_8h.html#ab3b8e87c6048edbab667d8c19812d6eb" title="prefix increment operator (directly manipulates the integer parts) ">operator++()</a> to advance to the next item and empty() to check for the end: </p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (!int_sorter.empty())</div>
<div class="line">{</div>
<div class="line">  std::cout &lt;&lt; *int_sorter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">  ++int_sorter;</div>
<div class="line">}</div>
</div><!-- fragment --><h3>Determine size / Check whether the map is empty</h3>
<p>To determine the size (i.e. the number of elements) of a sorter container, call size(): </p>
<div class="fragment"><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;number of elements in int_sorter: &quot;</span> &lt;&lt; int_sorter.size() &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>To check if the sorter is empty, call empty() which returns true in case: </p>
<div class="fragment"><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;is int_sorter empty? &quot;</span> &lt;&lt; int_sorter.empty() &lt;&lt; std::endl;</div>
</div><!-- fragment --><h3>A minimal working example of STXXL's sorter</h3>
<p>(See <a class="el" href="examples_2containers_2sorter1_8cpp-example.html">examples/containers/sorter1.cpp</a> for the sourcecode of the following example).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sorter.html">stxxl/sorter</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="stats.html">stxxl/stats</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="timer.html">stxxl/timer</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>my_comparator</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> operator () (<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; a, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; b)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> a &lt; b;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> min_value()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="uint__types_8h.html#a969c1286bbe8eeb8811dac7a462d4a78">std::numeric_limits&lt;int&gt;::min</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> max_value()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="uint__types_8h.html#a0cfacbbf6e846521326f5de5ba3ecd05">std::numeric_limits&lt;int&gt;::max</a>();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// template parameter &lt;ValueType, CompareType, BlockSize, AllocStr(optional)&gt;</span></div>
<div class="line">    <span class="keyword">typedef</span> <a class="code" href="classstxxl_1_1sorter.html">stxxl::sorter&lt;int, my_comparator&gt;</a> sorter_type;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// create sorter object (CompareType(), MainMemoryLimit)</span></div>
<div class="line">    sorter_type int_sorter(my_comparator(), 64 * 1024 * 1024);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// fill sorter with elements order in descending order</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1000; i &gt; 0; i--)</div>
<div class="line">    {</div>
<div class="line">        int_sorter.push(i);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    int_sorter.sort();  <span class="comment">// sort elements (in ascending order)</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// walk through sorted values and print them out</span></div>
<div class="line">    <span class="keywordflow">while</span> (!int_sorter.empty())</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; *int_sorter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">        ++int_sorter;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> See <a class="el" href="examples_2containers_2sorter2_8cpp-example.html">examples/containers/sorter2.cpp</a> for the sourcecode of a more comprehensive example. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Welcome to STXXL</a></li><li class="navelem"><a class="el" href="tutorial.html">Tutorials and Examples</a></li>
    <li class="footer"><a href="http://github.com/stxxl/stxxl/commit/263df0c54dc168212d1c7620e3c10c93791c9c29">STXXL 1.4.1-382-g263df0c</a><script type="text/javascript">
var _paq = _paq || [];  _paq.push(['trackPageView']);  _paq.push(['enableLinkTracking']);  (function() {    var u='http://panthema.net/wik-331/';    _paq.push(['setTrackerUrl', u+'js/']);    _paq.push(['setSiteId', '1']);    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';    g.defer=true; g.async=true; g.src=u+'js/'; s.parentNode.insertBefore(g,s);  })();
</script>
<noscript><img src="http://panthema.net/wik-331/js/?idsite=1&amp;rec=1" style="border:0" alt="" /></noscript> - Generated on Wed Sep 27 2017 06:26:07 for STXXL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
